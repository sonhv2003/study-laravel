//////////////////////////////////////////////////////////////////////////////////
// Cloud Zoom V1.0.2
// (c) 2010 by R Cecco. <http://www.professorcloud.com>
// MIT License
//
// Please retain this copyright header in all versions of the software
//////////////////////////////////////////////////////////////////////////////////
(function(b){function n(g){for(var e=1;e<arguments.length;e++)g=g.replace("%"+(e-1),arguments[e]);return g}function H(g,e){var d=b("img",g),k,f=null,i=null,h=null,m=null,l=null,u=null,o,C=0,s,t,D=0,E=0,y=0,z=0,F=0,A,B,v=this,G;setTimeout(function(){if(i===null){var c=g.width();g.parent().append(n('<div style="width:%0px;position:absolute;top:75%;left:%1px;text-align:center" class="cloud_zoom_loading" >Loading...</div>',c/3,c/2-c/6)).find(":last").css("opacity",0.5)}},1);var I=function(){if(u!==null){u.remove();
u=null}b(".cloud_zoom_wrap iframe").remove()};this.removeBits=function(){if(h){h.remove();h=null}if(m){m.remove();m=null}if(l){l.remove();l=null}I();b(".cloud_zoom_loading",g.parent()).remove()};this.destroy=function(){g.data("zoom",null);if(i){i.unbind();i.remove();i=null}if(f){f.remove();f=null}this.removeBits()};this.fadedOut=function(){if(f){f.remove();f=null}this.removeBits()};this.controlLoop=function(){if(h){var c=A-d.offset().left-s*0.5>>0,j=B-d.offset().top-t*0.5>>0;if(c<0)c=0;else if(c>
d.outerWidth()-s)c=d.outerWidth()-s;if(j<0)j=0;else if(j>d.outerHeight()-t)j=d.outerHeight()-t;h.css({left:c,top:j});h.css("background-position",-c+"px "+-j+"px");D=c/d.outerWidth()*o.width>>0;E=j/d.outerHeight()*o.height>>0;z+=(D-z)/e.smoothMove;y+=(E-y)/e.smoothMove;f.css("background-position",-(z>>0)+"px "+(-(y>>0)+"px"))}C=setTimeout(function(){v.controlLoop()},30)};this.init2=function(c,j){F++;if(j===1)o=c;F===2&&this.init()};this.init=function(){b(".cloud_zoom_loading",g.parent()).remove();
i=g.parent().append(n("<div class='mousetrap' style='background-image:url(\".\");z-index:9;position:absolute;width:%0px;height:%1px;left:%2px;top:%3px;'></div>",d.outerWidth(),d.outerHeight(),0,0)).find(":last");i.bind("mousemove",this,function(c){A=c.pageX;B=c.pageY});i.bind("mouseleave",this,function(){clearTimeout(C);h&&h.fadeOut(299);m&&m.fadeOut(299);l&&l.fadeOut(299);f.fadeOut(300,function(){v.fadedOut()});return false});i.bind("mouseenter",this,function(c){A=c.pageX;B=c.pageY;G=c.data;if(f){f.stop(true,
false);f.remove()}c=e.adjustX;var j=e.adjustY,w=d.outerWidth(),x=d.outerHeight(),p=e.zoomWidth,q=e.zoomHeight;if(e.zoomWidth=="auto")p=w;if(e.zoomHeight=="auto")q=x;var r=g.parent();switch(e.position){case "top":j-=q;break;case "right":c+=w;break;case "bottom":j+=x;break;case "left":c-=p;break;case "inside":p=w;q=x;break;default:r=b("#"+e.position);if(r.length){p=r.innerWidth();q=r.innerHeight()}else{r=g;c+=w;j+=x}}f=r.append(n('<div id="cloud_zoom_big" class="cloud_zoom_big" style="display:none;position:absolute;left:%0px;top:%1px;width:%2px;height:%3px;background-image:url(\'%4\');z-index:8;"></div>',
c,j,p,q,o.src)).find(":last");d.attr("title")&&e.showTitle&&f.append(n('<div class="cloud_zoom_title">%0</div>',d.attr("title"))).find(":last").css("opacity",e.titleOpacity);if(b.browser.msie&&b.browser.version<7)u=b('<iframe frameborder="0" src="#"></iframe>').css({position:"absolute",left:c,top:j,zIndex:8,width:p,height:q}).insertBefore(f);f.fadeIn(500);if(h){h.remove();h=null}s=d.outerWidth()/o.width*f.width();t=d.outerHeight()/o.height*f.height();h=g.append(n("<div class = 'cloud_zoom_lens' style='display:none;z-index:7;position:absolute;width:%0px;height:%1px;'></div>",
s,t)).find(":last");i.css("cursor",h.css("cursor"));c=false;if(e.tint){h.css("background",'url("'+d.attr("src")+'")');m=g.append(n('<div style="display:none;position:absolute; left:0px; top:0px; width:%0px; height:%1px; background-color:%2;" />',d.outerWidth(),d.outerHeight(),e.tint)).find(":last");m.css("opacity",e.tintOpacity);c=true;m.fadeIn(500)}if(e.softFocus){h.css("background",'url("'+d.attr("src")+'")');l=g.append(n('<div style="position:absolute;display:none;top:2px; left:2px; width:%0px; height:%1px;" />',
d.outerWidth()-2,d.outerHeight()-2,e.tint)).find(":last");l.css("background",'url("'+d.attr("src")+'")');l.css("opacity",0.5);c=true;l.fadeIn(500)}c||h.css("opacity",e.lensOpacity);e.position!=="inside"&&h.fadeIn(500);G.controlLoop()})};k=new Image;b(k).load(function(){v.init2(this,0)});k.src=d.attr("src");k=new Image;b(k).load(function(){v.init2(this,1)});k.src=g.attr("href")}b(document).ready(function(){b(".cloud_zoom, .cloud_zoom_gallery").CloudZoom()});b.fn.CloudZoom=function(g){try{document.execCommand("BackgroundImageCache",
false,true)}catch(e){}this.each(function(){var d,k;eval("var\ta = {"+b(this).attr("rel")+"}");d=a;if(b(this).is(".cloud_zoom")){b(this).css({position:"relative",display:"block"});b("img",b(this)).css({display:"block"});b(this).parent().attr("class")!="cloud_zoom_wrap"&&b(this).wrap('<div class="cloud_zoom_wrap" style="top:0px;z-index:11;position:relative;"></div>');k=b.extend({},b.fn.CloudZoom.defaults,g);k=b.extend({},k,d);b(this).data("zoom",new H(b(this),k))}else if(b(this).is(".cloud_zoom_gallery")){k=
b.extend({},d,g);b(this).data("relOpts",k);b(this).bind("click mouseenter",b(this),function(f){var i=f.data.data("relOpts");b("#"+i.useZoom).data("zoom").destroy();b("#"+i.useZoom).attr("href",f.data.attr("href"));b("#"+i.useZoom+" img").attr("src",f.data.data("relOpts").smallImage);b("#"+i.useZoom+" img").attr("title",f.data.data("relOpts").title);b("#"+f.data.data("relOpts").useZoom).CloudZoom();return false})}});return this};b.fn.CloudZoom.defaults={zoomWidth:"360",zoomHeight:"360",position:"right",
tint:false,tintOpacity:0.5,lensOpacity:0.5,softFocus:false,smoothMove:3,showTitle:true,title:"",titleOpacity:0.5,adjustX:17,adjustY:0}})(jQuery);
